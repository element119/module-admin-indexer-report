<?xml version="1.0"?>
<!--
/**
 * Copyright © element119. All rights reserved.
 * See LICENCE.txt for licence details.
 */
-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <!-- Indexer Grid Batch Size Column -->
    <type name="Element119\AdminIndexerReport\Block\Backend\Grid\Column\Renderer\BatchSize">
        <arguments>
            <argument name="indexerBatchSizeClassMap" xsi:type="array">
                <!--
                1. The array key must match the indexer ID
                2. The object is the class that contains the relevant indexer batch size configuration
                3. The batchSizeKeyName is the name of the argument containing the batch size value in the given object

                @link https://developer.adobe.com/commerce/php/development/components/indexing/optimization/#batching-configuration
                -->

                <item name="catalog_category_product" xsi:type="array">
                    <item name="object" xsi:type="object">Magento\Catalog\Model\Indexer\Category\Product\Action\Full</item>
                    <item name="batchSizeKeyName" xsi:type="string">batchRowsCount</item>
                </item>
                <item name="cataloginventory_stock" xsi:type="array">
                    <item name="object" xsi:type="object">Magento\CatalogInventory\Model\Indexer\Stock\Action\Full</item>
                    <item name="batchSizeKeyName" xsi:type="string">batchRowsCount</item>
                </item>
                <item name="catalog_product_attribute" xsi:type="array">
                    <item name="object" xsi:type="object">Magento\Catalog\Model\ResourceModel\Product\Indexer\Eav\BatchSizeCalculator</item>
                    <item name="batchSizeKeyName" xsi:type="string">batchSizes</item>
                </item>
                <item name="catalog_product_price" xsi:type="array">
                    <item name="object" xsi:type="object">Magento\Catalog\Model\ResourceModel\Product\Indexer\Price\BatchSizeCalculator</item>
                    <item name="batchSizeKeyName" xsi:type="string">batchRowsCount</item>
                </item>
            </argument>
        </arguments>
    </type>

    <!-- Indexer Cron Report -->
    <type name="Element119\AdminIndexerReport\Model\IndexerCronInfo">
        <arguments>
            <!--
            List of cron_schedule table columns to display in the indexer-related cron report(s). Set the item name as
            the column name and the boolean value to flag whether to include the column or not. Note that the related
            grid configuration file may need to be updated when columns are added or removed.

            This configuration will be redundant if/when the Hyvä module allows SQL "WHERE" clauses to be included as
            part of the query grid source type.

            @see view/adminhtml/hyva-grid/indexer-cron-grid.xml
            @link https://github.com/hyva-themes/magento2-hyva-admin/blob/main/docs/guides/hyva-admin-grid-walkthrough/configuring-columns.md
            -->
            <argument name="cronScheduleColumns" xsi:type="array">
                <item name="schedule_id" xsi:type="boolean">true</item>
                <item name="job_code" xsi:type="boolean">true</item>
                <item name="status" xsi:type="boolean">true</item>
                <item name="messages" xsi:type="boolean">true</item>
                <item name="created_at" xsi:type="boolean">true</item>
                <item name="scheduled_at" xsi:type="boolean">true</item>
                <item name="executed_at" xsi:type="boolean">true</item>
                <item name="finished_at" xsi:type="boolean">true</item>
            </argument>

            <!--
            List of indexer-related cron jobs to report on. Set the item name as the cron job name and the boolean value
            to flag whether to report on the job or not.
            -->
            <argument name="indexerCronJobs" xsi:type="array">
                <item name="indexer_clean_all_changelogs" xsi:type="boolean">true</item>
                <item name="indexer_reindex_all_invalid" xsi:type="boolean">true</item>
                <item name="indexer_update_all_views" xsi:type="boolean">true</item>
            </argument>
        </arguments>
    </type>
</config>
